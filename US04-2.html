<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil - EcoCycle</title>
    <link rel="stylesheet" href="CSS/US04-2.css">

    <link rel="stylesheet" href="CSS/bootstrap.min.css">
    <link rel="stylesheet" href="CSS/estilo.css">
</head>
<body>
    <script>
        let activo = JSON.parse(localStorage.getItem("activo")) || false;
        if(activo==false){
            window.location.href = "US03-1.html";
        }
    </script>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <img src="Imagenes/ecocycle.png" alt="" class="img-fluid logo">
    
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item">
                        <a class="nav-link" href="US02.html">Inicio</a>
                    </li>
                    <li class="nav-item dropdown d-flex align-items-center">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Reciclaje
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="US08.html">Depositos</a></li>
                            <li><a class="dropdown-item" href="US11-1.html">Consejos</a></li>
                        </ul>
                    </li>
    
                    <li class="nav-item">
                        <a class="nav-link" href="US14.html">Eventos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="US21.html">Contactanos</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <img class="img-fluid img_user" src="Imagenes/fotoperfil.jpeg" alt="">
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="US04-1.html">Mi perfil</a></li>
                            <li><a class="dropdown-item" href="canje_eco_puntos.html">Canje de Eco-Puntos</a></li>
                            <li><a class="dropdown-item" href="historial_puntos.html">Historial Eco-Puntos</a></li>
                            <li><a class="dropdown-item" id="cerrarsesion" href="US03-1.html">Cerrar sesión</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <header>
        <h1>Mi Perfil</h1>
    </header>

    <main>
        <div class="BotonGuardar">
            <nav>
                <ul>
                    <li><a href="US04-1.html" id="guardarPerfil">Guardar Perfil</a></li>
                </ul>
            </nav>
        </div>

        <div class="FotoPerfil">
            <img src="Imagenes/fotoperfil.jpeg" alt="">
        </div>

        <div class="Info">
            <h2 id="nombre"></h2>
            <p>
                Nombre: <input type="text" name="" id="nombre_completo"> 
                <br><br>
                Correo:  <input type="text" id="correo">
                <br><br>
                Telefono: <input type="text" id="telefono">
            </p>
        </div>

        <div class="Preferencias">
            <p>
                <div class="LogrosRS">
                    ¿Compartir logros en redes sociales?
                    <input type="checkbox">
                </div>
                <br>
                <div>
                    Configuración recordatorios
                    <select name="Recordatorios" id="" onclick="a">
                        <option value="1">Diario</option>
                        <option value="2">Semanal</option>
                        <option value="3">Mensual</option>
                    </select>
                </div>
            </p>
            
        </div>

        <div class="Direccion">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1950.6099594198495!2d-77.00806127053504!3d-12.097091672800907!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9105c7d9c9ff612b%3A0x1b6025472c6aabde!2sC.%20Berruguette%20196%2C%20Lima%2015036!5e0!3m2!1ses-419!2spe!4v1729463419225!5m2!1ses-419!2spe" width="1100" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
    </main>

    <footer class="footer mt-auto py-3 text-light">
        <div class="d-flex justify-content-center mb-4">
            <div class="col-auto">
                <img src="Imagenes/ecocycle.png" alt="EcoCycle Logo" class="img-fluid img-thumbnail">
            </div>
        </div>
    
        <div class="container mt-3">
            <div class="row">
                <div class="col-md-3 col-sm-12 mb-4">
                    <h6>Sobre EcoCycle</h6>
                    <p>EcoCycle es una plataforma dedicada a promover el reciclaje responsable y brindar información clara y accesible para facilitar el manejo adecuado de residuos en Lima Metropolitana.</p>
                    <a href="#" class="footer-link">Más sobre nosotros</a>
                    <p class="h6 mt-2">© EcoCycle 2024. Todos los derechos reservados.</p>
                </div>
    
                <div class="col-md-3 col-sm-12 mb-4">
                    <h6>Información Útil</h6>
                    <div class="row">
                        <div class="col-12">
                            <a href="#" class="footer-link">Política de Privacidad</a>
                        </div>
                        <div class="col-12">
                            <a href="#" class="footer-link">Términos y Condiciones</a>
                        </div>
                        <div class="col-12">
                            <a href="#" class="footer-link">Libro de Reclamaciones</a>
                        </div>
                    </div>
                </div>
    
                <div class="col-md-3 col-sm-12 mb-4">
                    <h6>Contáctanos</h6>
                    <p>Dirección: Av. Guardia Civil Sur 875, Chorrillos, Lima</p>
                    <p>Email: contacto@ecocycle.pe</p>
                    <div class="social-icons">
                        <a href="#"><i class="fa-brands fa-facebook-f text-light"></i></a>
                        <a href="#"><i class="fa-brands fa-youtube text-light"></i></a>
                        <a href="#"><i class="fa-brands fa-twitter text-light"></i></a>
                    </div>
                </div>
    
                <div class="col-md-3 col-sm-12 mb-4">
                    <h6>Suscríbete</h6>
                    <p>Recibe las mejores recomendaciones de reciclaje y consejos ambientales directamente en tu correo.</p>
                    <form>
                        <input type="email" class="form-control mb-2" placeholder="Correo electrónico">
                        <button type="submit" class="btn btn-primary">Suscribirse</button>
                    </form>
                </div>
            </div>
        </div>
    </footer>

    <script src="js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById("cerrarsesion").addEventListener("click",function(){
            localStorage.removeItem("activo");
            localStorage.removeItem("user_activo");
        });

        const user = JSON.parse(localStorage.getItem("user_activo")) || [];
        document.getElementById("nombre").innerText=user.name;
        document.getElementById("nombre_completo").value=user.name;
        document.getElementById("correo").value=user.email;
        document.getElementById("telefono").value=user.phone;

        document.getElementById("guardarPerfil").addEventListener("click",function(){
            let user = JSON.parse(localStorage.getItem("user_activo"));

            if (user) {
                user.name = document.getElementById("nombre_completo").value;
                user.email = document.getElementById("correo").value;
                user.phone = document.getElementById("telefono").value;
                localStorage.setItem("user_activo", JSON.stringify(user));

                const users = JSON.parse(localStorage.getItem("users")) || [];
                for(let i =0; i<users.length; i++){
                    if(users[i].id==user.id){
                        users[i].name = document.getElementById("nombre_completo").value;
                        users[i].email = document.getElementById("correo").value;
                        users[i].phone = document.getElementById("telefono").value;
                        break;
                    }
                }
                localStorage.setItem("users", JSON.stringify(users));
                alert("Perfil guardado con éxito.");
            } else {
                alert("Error: No se encontró un usuario activo.");
            }

        })
    </script>
</body>
</html>